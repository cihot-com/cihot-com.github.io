import{d as n,r as e,e as t,j as r,b as o}from"./index-d2e29b82.js";var d=n("div",{target:"e1njgdhz0"})({name:"1pg5eum",styles:"section{display:flex;}"}),c=function(){return Math.random().toString(36).slice(2,10)};var s=function(n){var e=new SharedWorker(n,{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ddb-worker"});return e.port.start(),e};var i=function(){var n=e.useState(1),i=t(n,2),g=i[0],u=i[1],a=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"module",o=e.useState((function(){return new Worker(n,{type:r,name:c()})})),d=t(o,2),s=d[0],i=d[1],g=e.useCallback((function(n){s.addEventListener("message",n)}),[s,i]),u=e.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;s.terminate(),i(new Worker(e,{type:r,name:c()}))}),[n,r,s,i]),a=e.useCallback((function(n){s.postMessage(n)}),[s,i]);return e.useEffect((function(){var n=function(n){n.data,n.source,n.origin},e=function(n){};return s.addEventListener("message",n,!1),s.addEventListener("error",e,!1),s.addEventListener("messageerror",n,!1),function(){s.removeEventListener("message",n,!1),s.removeEventListener("error",e,!1),s.removeEventListener("messageerror",n,!1),s.terminate()}}),[s]),e.useEffect((function(){var n=function(n){};return addEventListener("rejectionhandled",n,!1),addEventListener("unhandledrejection",n,!1),function(){removeEventListener("rejectionhandled",n,!1),removeEventListener("unhandledrejection",n,!1)}}),[]),{worker:s,on:g,reset:u,send:a}}("data:video/mp2t;base64,ZXhwb3J0IHt9OwoKY29uc29sZS5sb2coJ1t3b3JrZXIudHNdJywgbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpKTsKCmltcG9ydCB7IG51bWJlciB9IGZyb20gJ2VjaGFydHMnOwppbXBvcnQgeyBnZXRBcnJheUJ1ZmZlciB9IGZyb20gJy4vdXRpbCc7Cgpjb25zdCBwb29sOiBhbnlbXSA9IFtdOwoKLyogbWVzc2FnZSAqLwphZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHsKICBjb25zdCB7IGRhdGEsIHNvdXJjZSwgb3JpZ2luIH0gPSBldmVudDsKICBjb25zb2xlLmxvZygnJWNbd29ya2VyLnRzXScsICdiYWNrZ3JvdW5kOiMwMGY4JywgZGF0YSwgc291cmNlLCBvcmlnaW4sIGV2ZW50KTsKCiAgaWYgKGRhdGEpIHsKICAgIHBvb2wucHVzaChkYXRhKTsKICB9IGVsc2UgewogICAgY29uc3QgdiA9IHBvb2wuc2hpZnQoKTsKICAgIGNvbnN0IGFiID0gZ2V0QXJyYXlCdWZmZXIodik7CgogICAgaWYgKGFiKSB7CiAgICAgIC8vIHBvc3RNZXNzYWdlKGFiLCAnKicsIFthYl0pOwogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHBvc3RNZXNzYWdlKGFiLCBbYWJdKTsKICAgIH0gZWxzZSB7CiAgICAgIHBvc3RNZXNzYWdlKHYpOwogICAgfQogIH0KCiAgcG9zdE1lc3NhZ2UoZGF0YSk7Cn0pOwoKLyogZXJyb3IgKi8KYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoZXZlbnQ6IEVycm9yRXZlbnQpID0+IHsKICBjb25zb2xlLndhcm4oJ1t3b3JrZXIudHMgLSBlcnJvcl0nLCBldmVudCk7Cn0pOwoKLyogbWVzc2FnZWVycm9yICovCmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2VlcnJvcicsIChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB7CiAgY29uc29sZS53YXJuKCdbd29ya2VyLnRzIC0gbWVzc2FnZWVycm9yXScsIGV2ZW50KTsKfSk7CgovLyBwb3N0TWVzc2FnZSh7IHN0YXR1czogJ3JlYWR5JyB9KTsKLy8KLy8gbGV0IGNvdW50OiBudW1iZXIgPSAwOwovLyBzZXRJbnRlcnZhbCgoKSA9PiB7Ci8vICAgcG9zdE1lc3NhZ2UoKytjb3VudCk7Ci8vIH0sIDEwMDApOwo="),C=a.worker,l=a.reset,I=function(n){var r=e.useState((function(){return s(n)})),o=t(r,2),d=o[0];return o[1],{sharedWorker:d,on:function(n,e){d.port.addEventListener(n,e)},reset:s,send:function(n){d.port.postMessage(n)}}}("data:video/mp2t;base64,bGV0IGNvdW50OiBudW1iZXIgPSAwOwpjb25zdCBzdGFydEF0ID0gRGF0ZS5ub3coKTsKCmFkZEV2ZW50TGlzdGVuZXIoJ2Nvbm5lY3QnLCAoZXZlbnQ6IGFueSkgPT4gewogIGNvbnN0IHsgcG9ydHMgfSA9IGV2ZW50OwogIGNvbnNvbGUubG9nKCdbc2hhcmVkV29ya2VyLnRzXScsIG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKSwgcG9ydHMpOwoKICBBcnJheS5mcm9tKHBvcnRzKS5mb3JFYWNoKChwb3J0OiBhbnkpID0+IHsKICAgIHBvcnQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdbc2hhcmVkV29ya2VyLnRzIC0gbWVzc2FnZV0nLCBldmVudCk7CgogICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgZGF0YTogZXZlbnQuZGF0YSwgZnJvbTogJ3NoYXJlZFdvcmtlci50cycgfSk7CiAgICB9KTsKCiAgICBwb3J0LnN0YXJ0KCk7CgogICAgcG9ydC5wb3N0TWVzc2FnZSh7IGNvdW50OiArK2NvdW50LCBzdGFydEF0LCBwb3J0c0xlbmd0aDogcG9ydHMubGVuZ3RoIH0pOwogIH0pOwp9KTsKCi8vCi8vCi8vIGFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4gewovLyAgIHBvc3RNZXNzYWdlKGV2ZW50LmRhdGEpOwovLyB9KTsKLy8KLy8gbGV0IGNvdW50OiBudW1iZXIgPSAwOwovLyBwb3N0TWVzc2FnZSh7IHN0YXR1czogKytjb3VudCB9KTsKLy8KLy8gc2V0SW50ZXJ2YWwoKCkgPT4gewovLyAgIHBvc3RNZXNzYWdlKHsgc3RhdHVzOiArK2NvdW50IH0pOwovLyB9LCAxMDAwKTsK"),b=I.sharedWorker;return e.useEffect((function(){b.port.start(),b.port.addEventListener("message",(function(n){}))})),r(d,{children:[r("section",{children:[r("button",{onClick:function(){return u(g+1)},children:["count: ",g]}),o("button",{onClick:function(){return l()},children:"reset"}),o("button",{onClick:function(){return C.postMessage("string")},children:"send string"}),o("button",{onClick:function(){return C.postMessage({a:1})},children:"send object"}),o("button",{onClick:function(){return C.postMessage([1,2,3])},children:"send array"}),o("button",{onClick:function(){return C.postMessage(new ArrayBuffer(10))},children:"send arrayBuffer"}),o("button",{onClick:function(){var n=new ArrayBuffer(10);C.postMessage(n,[n])},children:"send arrayBuffer and transfer"}),o("button",{onClick:function(){return C.postMessage(new Int32Array([1,2,3]))},children:"send typedArray"}),o("button",{onClick:function(){var n=new Int32Array([1,2,3]);C.postMessage(n,[n.buffer])},children:"send typedArray and transfer"})]}),o("section",{children:o("button",{onClick:function(){return b.port.postMessage("string")},children:"sw.send"})})]})};i.displayName="Worker";export{i as default};
